version: '3'
services:
  lost_grandma:
    depends_on:
      - tor
    build: .
    image: ${LOST_GRANDMA_IMAGE_ID}
    env_file:
      - development.env
    networks:
      - main_network   
    command: ['./launch.sh']
  worker:
    depends_on:
      - tor
    build: .
    image: ${LOST_GRANDMA_IMAGE_ID}
    env_file:
      - development.env
    networks:
      - main_network  
    command: ["./launch_workers.sh"]
  tor:
    networks:
      - main_network
    build:
      context: ./scripts/tor
      dockerfile: Dockerfile
    image: ${TOR_IMAGE_ID}
    expose:
      - 9050
      - 9080
      - 9051
    ports:
      - "9050:9050"
      - "9051:9051"
      - "9080:9080"
    command: ["./launch_tor.sh"]
networks:
  main_network: